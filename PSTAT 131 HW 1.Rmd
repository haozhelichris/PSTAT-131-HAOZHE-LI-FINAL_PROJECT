---
title: "PSTAT 131 HW 1"
author: "Haozhe Li"
date: "2022-09-30"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Exercise 1:

We are interested in highway miles per gallon, or the hwy variable. Create a histogram of this variable. Describe what you see/learn.
```{r}
library(ggplot2)
p <- ggplot(mpg,aes(x=hwy))+geom_histogram(bins=10)+xlab("Highway miles per gallon")+ylab("Number of Cars")+ggtitle("Histogram of highway miles per gallon")
p
```

We can see from the graph that there are a small amount of cars that able to have the highway miles per gallon over 40. Most of the cars hyw are clustered around 15 to 30 and they are more likely to be around 15-20 and 25-30. So I think its is really hard to achieve the extremely high highway fuel efficiency (like above 40) but it is reasonably easy to achieve a reasonably good efficiency (around 15-30)



Exercise 2:

Create a scatterplot. Put hwy on the x-axis and cty on the y-axis. Describe what you notice. Is there a relationship between hwy and cty? What does this mean?
```{r}
p <- ggplot(mpg,aes(x=hwy,y=cty))+geom_point()+xlab("Highway miles per gallon")+ylab("City miles per gallon")+ggtitle("Scatterplot of Highway miles per gallon and City miles per gallon")+geom_smooth(method = lm)
p
```

From the graph we can see that when highway miles per gallon increase the city miles per gallon will increase as well and all the data scattered around the line I created to distinguish whether they have a linear relationship and seems like the data fit the line pretty good since they scattered mostly evenly around the line. So that means there is a relationship between hwy and cty. The cars which have the better highway miles per gallon tends to have a better city miles per gallon as well. 


Exercise 3:

Make a bar plot of manufacturer. Flip it so that the manufacturers are on the y-axis. Order the bars by height. Which manufacturer produced the most cars? Which produced the least?
```{r}
ggplot(mpg, aes(x=forcats::fct_infreq(manufacturer)))+geom_bar(stat="count")+coord_flip()+xlab("Names of cars")+ylab("Numbers of the cars")
```

Dodge produce the most cars and the lincoln produce the least


Exercise 4:

Make a box plot of hwy, grouped by cyl. Do you see a pattern? If so, what?
```{r}
cyl1 <-as.factor(mpg$cyl)
a <- ggplot(mpg,aes(y=hwy,x=cyl1))+geom_boxplot()+xlab("Cylinder")+ylab("Highway miels per gallon")+ggtitle("Box of highway miles per gallon grouped by cylinder")
a
```

The pattern is the more cylinder the car have they tend to have less miles per gallon no the highway which means if the car have a less cylinder they tend to have a better fuel efficiency

Exercise 5:
Use the corrplot package to make a lower triangle correlation matrix of the mpg dataset. (Hint: You can find information on the package here.)

Which variables are positively or negatively correlated with which others? Do these relationships make sense to you? Are there any that surprise you?
```{r}
library(dplyr)
library(corrplot)
mpg1<-select_if(mpg,is.numeric)
m=cor(mpg1)
corrplot(m,method = 'number',order = 'FPC', type = 'lower',diag = FALSE)
```

CTY have the positive relationship with hwy and negative with year, displ,cyl
HWY have the positive relationship with year and negative with displ, cyl
Year have the positive  relationship with displ and cyl 
Displ have the postive relationship with cyl
They mostly make sense to me
